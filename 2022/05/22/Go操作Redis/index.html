<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Go操作Redis | Qing's Blog</title><meta name="description" content="Go操作Redis  Redis是一个开源的内存数据库，Redis提供了多种不同类型的数据结构，很多业务场景下的问题都可以很自然地映射到这些数据结构上。除此之外，通过复制、持久化和客户端分片等特性，我们可以很方便地将Redis扩展成一个能够包含数百GB数据、每秒处理上百万次请求的系统。 Redis支持的数据结构：  字符串（string） 哈希（hash） 列表（list） 集合（set） 有序"><meta name="keywords" content="Go操作Redis"><meta name="author" content="qingbo,qingbo1011@163.com"><meta name="copyright" content="qingbo"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220501212415.jpg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Go操作Redis"><meta name="twitter:description" content="Go操作Redis  Redis是一个开源的内存数据库，Redis提供了多种不同类型的数据结构，很多业务场景下的问题都可以很自然地映射到这些数据结构上。除此之外，通过复制、持久化和客户端分片等特性，我们可以很方便地将Redis扩展成一个能够包含数百GB数据、每秒处理上百万次请求的系统。 Redis支持的数据结构：  字符串（string） 哈希（hash） 列表（list） 集合（set） 有序"><meta name="twitter:image" content="https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220715143752.png"><meta property="og:type" content="article"><meta property="og:title" content="Go操作Redis"><meta property="og:url" content="http://www.qingbo1011.top/2022/05/22/Go%E6%93%8D%E4%BD%9CRedis/"><meta property="og:site_name" content="Qing's Blog"><meta property="og:description" content="Go操作Redis  Redis是一个开源的内存数据库，Redis提供了多种不同类型的数据结构，很多业务场景下的问题都可以很自然地映射到这些数据结构上。除此之外，通过复制、持久化和客户端分片等特性，我们可以很方便地将Redis扩展成一个能够包含数百GB数据、每秒处理上百万次请求的系统。 Redis支持的数据结构：  字符串（string） 哈希（hash） 列表（list） 集合（set） 有序"><meta property="og:image" content="https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220715143752.png"><meta property="article:published_time" content="2022-05-22T00:47:03.000Z"><meta property="article:modified_time" content="2023-10-03T08:16:11.761Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="http://www.qingbo1011.top/2022/05/22/Go%E6%93%8D%E4%BD%9CRedis/"><link rel="prev" title="Iris入门" href="http://www.qingbo1011.top/2022/05/30/Iris%E5%85%A5%E9%97%A8/"><link rel="next" title="Gin+Websocket+MangoDB实现的IM系统" href="http://www.qingbo1011.top/2022/05/21/Gin+WebSocket+MongoDB%E7%9A%84IM%E5%8D%B3%E6%97%B6%E8%81%8A%E5%A4%A9Demo/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: true,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: true,
  islazyload: false,
  isanchor: true
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"></head><body><canvas class="fireworks"></canvas><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220501212415.jpg" onerror="onerror=null;src='https://gitee.com/qingyu1011/blog_img/raw/master/img/20201006230440.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">87</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">81</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">15</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#go操作redis"><span class="toc-number">1.</span> <span class="toc-text"> Go操作Redis</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#客户端连接"><span class="toc-number">2.</span> <span class="toc-text"> 客户端连接</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#基本指令"><span class="toc-number">3.</span> <span class="toc-text"> 基本指令</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#keys根据正则获取keys"><span class="toc-number">3.1.</span> <span class="toc-text"> Keys():根据正则获取keys</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#type获取key对应值得类型"><span class="toc-number">3.2.</span> <span class="toc-text"> Type():获取key对应值得类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#del删除缓存项"><span class="toc-number">3.3.</span> <span class="toc-text"> Del():删除缓存项</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#exists检测缓存项是否存在"><span class="toc-number">3.4.</span> <span class="toc-text"> Exists():检测缓存项是否存在</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#expireexpireat设置有效期"><span class="toc-number">3.5.</span> <span class="toc-text"> Expire()&amp;ExpireAt():设置有效期</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ttlpttl获取有效期"><span class="toc-number">3.6.</span> <span class="toc-text"> TTL(),PTTL():获取有效期</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dbsize查看当前数据库key的数量"><span class="toc-number">3.7.</span> <span class="toc-text"> DBSize():查看当前数据库key的数量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flushdb清空当前数据"><span class="toc-number">3.8.</span> <span class="toc-text"> FlushDB():清空当前数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flushall清空所有数据库"><span class="toc-number">3.9.</span> <span class="toc-text"> FlushAll():清空所有数据库</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#字符串string类型"><span class="toc-number">4.</span> <span class="toc-text"> 字符串(string)类型</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#set-设置"><span class="toc-number">4.1.</span> <span class="toc-text"> Set() 设置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#setex-设置并指定过期时间"><span class="toc-number">4.2.</span> <span class="toc-text"> SetEX() 设置并指定过期时间</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#setnx-设置并指定过期时间"><span class="toc-number">4.3.</span> <span class="toc-text"> SetNX() 设置并指定过期时间</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#get-获取"><span class="toc-number">4.4.</span> <span class="toc-text"> Get() 获取</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#getrange-字符串截取"><span class="toc-number">4.5.</span> <span class="toc-text"> GetRange() 字符串截取</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#incr-增加1"><span class="toc-number">4.6.</span> <span class="toc-text"> Incr() 增加(+1)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#incrby-增加按指定步长"><span class="toc-number">4.7.</span> <span class="toc-text"> IncrBy() 增加(按指定步长)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#decr-减少-1"><span class="toc-number">4.8.</span> <span class="toc-text"> Decr() 减少(-1)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#decrby-减少按指定步长"><span class="toc-number">4.9.</span> <span class="toc-text"> DecrBy() 减少(按指定步长)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#append-追加"><span class="toc-number">4.10.</span> <span class="toc-text"> Append() 追加</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#strlen-获取长度"><span class="toc-number">4.11.</span> <span class="toc-text"> StrLen() 获取长度</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#哈希hash类型"><span class="toc-number">5.</span> <span class="toc-text"> 哈希(hash)类型</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#hset-设置"><span class="toc-number">5.1.</span> <span class="toc-text"> HSet() 设置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hmset-批量设置"><span class="toc-number">5.2.</span> <span class="toc-text"> HMset() 批量设置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hget-获取某个元素"><span class="toc-number">5.3.</span> <span class="toc-text"> HGet() 获取某个元素</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hgetall-获取全部元素"><span class="toc-number">5.4.</span> <span class="toc-text"> HGetAll() 获取全部元素</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hdel-删除某个元素"><span class="toc-number">5.5.</span> <span class="toc-text"> HDel() 删除某个元素</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hexists-判断元素是否存在"><span class="toc-number">5.6.</span> <span class="toc-text"> HExists() 判断元素是否存在</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hlen-获取长度"><span class="toc-number">5.7.</span> <span class="toc-text"> HLen() 获取长度</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#列表list类型"><span class="toc-number">6.</span> <span class="toc-text"> 列表(list)类型</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#lpush-将元素从左侧压入链表"><span class="toc-number">6.1.</span> <span class="toc-text"> LPush() 将元素从左侧压入链表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rpush-将元素从右侧压入链表"><span class="toc-number">6.2.</span> <span class="toc-text"> RPush() 将元素从右侧压入链表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#linsert-在某个位置插入新元素"><span class="toc-number">6.3.</span> <span class="toc-text"> LInsert() 在某个位置插入新元素</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#lset-设置某个元素的值"><span class="toc-number">6.4.</span> <span class="toc-text"> LSet() 设置某个元素的值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#llen-获取列表元素个数"><span class="toc-number">6.5.</span> <span class="toc-text"> LLen() 获取列表元素个数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#lindex-根据索引获取列表元素"><span class="toc-number">6.6.</span> <span class="toc-text"> LIndex() 根据索引获取列表元素</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#lrange-获取某个选定范围的元素集"><span class="toc-number">6.7.</span> <span class="toc-text"> LRange() 获取某个选定范围的元素集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#lpop-从列表左侧弹出数据"><span class="toc-number">6.8.</span> <span class="toc-text"> LPop() 从列表左侧弹出数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rpop-从列表右侧弹出数据"><span class="toc-number">6.9.</span> <span class="toc-text"> RPop() 从列表右侧弹出数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#lrem-根据值移除元素"><span class="toc-number">6.10.</span> <span class="toc-text"> LRem() 根据值移除元素</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#集合set类型"><span class="toc-number">7.</span> <span class="toc-text"> 集合(set)类型</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#sadd-添加元素"><span class="toc-number">7.1.</span> <span class="toc-text"> SAdd() 添加元素</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#spop-随机弹出一个元素"><span class="toc-number">7.2.</span> <span class="toc-text"> SPop() 随机弹出一个元素</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#spopn-随机弹出多个元素"><span class="toc-number">7.3.</span> <span class="toc-text"> SPopN() 随机弹出多个元素</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#srem-删除集合里指定的值"><span class="toc-number">7.4.</span> <span class="toc-text"> SRem() 删除集合里指定的值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#smembers-获取所有成员"><span class="toc-number">7.5.</span> <span class="toc-text"> SMembers() 获取所有成员</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sismember-判断元素是否在集合中"><span class="toc-number">7.6.</span> <span class="toc-text"> SIsMember() 判断元素是否在集合中</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#scard-获取集合元素个数"><span class="toc-number">7.7.</span> <span class="toc-text"> SCard() 获取集合元素个数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sunion-并集sdiff-差集sinter-交集"><span class="toc-number">7.8.</span> <span class="toc-text"> SUnion() 并集；SDiff() 差集；SInter() 交集</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#有序集合zset类型"><span class="toc-number">8.</span> <span class="toc-text"> 有序集合(zset)类型</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#zadd-添加元素"><span class="toc-number">8.1.</span> <span class="toc-text"> ZAdd() 添加元素</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#zincrby-增加元素分值"><span class="toc-number">8.2.</span> <span class="toc-text"> ZIncrBy() 增加元素分值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#zrangezrevrange-获取根据score排序后的数据段"><span class="toc-number">8.3.</span> <span class="toc-text"> ZRange()&amp;ZRevRange() 获取根据score排序后的数据段</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#zcard-获取元素个数"><span class="toc-number">8.4.</span> <span class="toc-text"> ZCard() 获取元素个数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#zcount-获取区间内元素个数"><span class="toc-number">8.5.</span> <span class="toc-text"> ZCount() 获取区间内元素个数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#zscore-获取元素的score"><span class="toc-number">8.6.</span> <span class="toc-text"> ZScore() 获取元素的score</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#zrankzrevrank-获取某个元素在集合中的排名"><span class="toc-number">8.7.</span> <span class="toc-text"> ZRank()&amp;ZRevRank() 获取某个元素在集合中的排名</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#zrem-删除元素"><span class="toc-number">8.8.</span> <span class="toc-text"> ZRem() 删除元素</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#zremrangebyrank-根据排名删除"><span class="toc-number">8.9.</span> <span class="toc-text"> ZRemRangeByRank() 根据排名删除</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#zremrangebyscore-根据分值区间删除"><span class="toc-number">8.10.</span> <span class="toc-text"> ZRemRangeByScore() 根据分值区间删除</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220715143752.png)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Qing's Blog</a></span><span class="pull_right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">Go操作Redis</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2022-05-22 08:47:03"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2022-05-22</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2023-10-03 16:16:11"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2023-10-03</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Database/">Database</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="post-meta__icon fa fa-file-word-o" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">8.9k</span><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-clock-o" aria-hidden="true"></i><span>阅读时长: 40 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-comment-o" aria-hidden="true"></i><span>评论数:</span><a href="/2022/05/22/Go%E6%93%8D%E4%BD%9CRedis/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2022/05/22/Go%E6%93%8D%E4%BD%9CRedis/" itemprop="commentCount"></span></a></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1 id="go操作redis"><a class="markdownIt-Anchor" href="#go操作redis"></a> Go操作Redis</h1>
<blockquote>
<p>Redis是一个开源的内存数据库，Redis提供了多种不同类型的数据结构，很多业务场景下的问题都可以很自然地映射到这些数据结构上。除此之外，通过复制、持久化和客户端分片等特性，我们可以很方便地将Redis扩展成一个能够包含数百GB数据、每秒处理上百万次请求的系统。</p>
<p>Redis支持的数据结构：</p>
<ul>
<li><strong>字符串（string）</strong></li>
<li><strong>哈希（hash）</strong></li>
<li><strong>列表（list）</strong></li>
<li><strong>集合（set）</strong></li>
<li><strong>有序集合（sorted set）</strong></li>
<li>位图 ( Bitmaps )</li>
<li>基数统计 ( HyperLogLogs )</li>
</ul>
<p>Redis应用场景：</p>
<ul>
<li>缓存系统，减轻主数据库（MySQL）的压力</li>
<li>计数场景，比如微博、抖音中的关注数和粉丝数</li>
<li>热门排行榜，需要排序的场景特别适合使用ZSET</li>
<li>利用LIST可以实现队列的功能</li>
</ul>
</blockquote>
<p>关于Redis的介绍这里不再多说。可以参考<a href="https://www.qingbo1011.top/2021/04/08/Redis%E5%85%A5%E9%97%A8/">Redis入门 笔记</a>。</p>
<p>关于Redis的安装也不再多说，本地安装和docker安装（<a href="https://www.qingbo1011.top/2021/05/31/Docker%E5%AE%89%E8%A3%85%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/#docker%E5%AE%89%E8%A3%85redis">Docker安装Redis</a>）。</p>
<p>区别于另一个比较常用的Go语言redis client库：<a href="https://github.com/gomodule/redigo" target="_blank" rel="noopener">redigo</a>，我们这里采用https://github.com/go-redis/redis连接Redis数据库并进行操作，因为<code>go-redis</code>支持<strong>连接哨兵及集群模式的Redis</strong>。（See <a href="https://redis.uptrace.dev/guide/go-redis-vs-redigo.html" target="_blank" rel="noopener">Comparing go-redis vs redigo</a>.）</p>
<p><a href="https://www.tizi365.com/archives/290.html" target="_blank" rel="noopener">golang redis快速入门教程</a>（老版本，没有升级到V8）</p>
<p><strong><a href="https://studygolang.com/articles/32352" target="_blank" rel="noopener">Go操作Redis实战</a>（go-redis v8）</strong></p>
<p><a href="https://github.com/go-redis/redis" target="_blank" rel="noopener">Github：go -redis</a></p>
<p><strong><a href="https://www.liwenzhou.com/posts/Go/go_redis/" target="_blank" rel="noopener">go-redis V8新版本相关</a></strong></p>
<p><strong><a href="https://redis.uptrace.dev/" target="_blank" rel="noopener">Go Redis官网</a></strong>（<strong>建议多看官网！</strong>）</p>
<p><strong><a href="https://pkg.go.dev/github.com/go-redis/redis/v8#section-documentation" target="_blank" rel="noopener">go-redis v8 Documentation</a></strong></p>
<blockquote>
<p>If you are using <strong>Redis 6</strong>, install go-redis/<strong>v8</strong>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go get github.com/go-redis/redis/v8</span><br></pre></td></tr></table></figure>
<p>If you are using <strong>Redis 7</strong>, install go-redis/<strong>v9</strong> (currently in beta):</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go get github.com/go-redis/redis/v9</span><br></pre></td></tr></table></figure>
</blockquote>
<h1 id="客户端连接"><a class="markdownIt-Anchor" href="#客户端连接"></a> 客户端连接</h1>
<p>代码如下：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"context"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">	<span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	result, err := rdb.Ping(ctx).Result()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Fatalln(<span class="string">"连接redis出错，错误信息："</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">"成功连接redis"</span>)</span><br><span class="line">	fmt.Println(result) <span class="comment">// PONG</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>关于Context，官网是这样说的：</p>
<p>Every Redis command accepts a context that you can use to set <a href="https://redis.uptrace.dev/guide/go-redis-debugging.html#timeouts" target="_blank" rel="noopener">timeouts</a> or propagate some information, for example, <a href="https://redis.uptrace.dev/guide/redis-performance-monitoring.html" target="_blank" rel="noopener">tracing context</a>.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctx := context.Background()</span><br></pre></td></tr></table></figure>
<p>Background返回一个非空的Context。 它永远不会被取消，没有值，也没有期限。 它通常在main函数，初始化和测试时使用，并用作传入请求的顶级上下文。</p>
</blockquote>
<h1 id="基本指令"><a class="markdownIt-Anchor" href="#基本指令"></a> 基本指令</h1>
<p><a href="https://www.cnblogs.com/itbsl/p/14198111.html#%E5%9F%BA%E6%9C%AC%E6%8C%87%E4%BB%A4" target="_blank" rel="noopener">基本指令</a></p>
<h2 id="keys根据正则获取keys"><a class="markdownIt-Anchor" href="#keys根据正则获取keys"></a> Keys():根据正则获取keys</h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"context"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">	<span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	keys, err := rdb.Keys(ctx, <span class="string">"*"</span>).Result() <span class="comment">// *表示获取所有的key</span></span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Fatalln(err)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(keys)</span><br><span class="line">	fmt.Printf(<span class="string">"%T"</span>, keys) <span class="comment">// []string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="type获取key对应值得类型"><a class="markdownIt-Anchor" href="#type获取key对应值得类型"></a> Type():获取key对应值得类型</h2>
<p><code>Type()</code>：获取一个key对应值的类型。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"context"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">	<span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	vType, err := rdb.Type(ctx, <span class="string">"hash1"</span>).Result() <span class="comment">// 获取key为test的类型</span></span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Fatalln(err)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(vType)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="del删除缓存项"><a class="markdownIt-Anchor" href="#del删除缓存项"></a> Del():删除缓存项</h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   n, err := rdb.Del(ctx, <span class="string">"test"</span>, <span class="string">"hello"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(<span class="string">"成功删除了"</span>, n, <span class="string">"个key"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="exists检测缓存项是否存在"><a class="markdownIt-Anchor" href="#exists检测缓存项是否存在"></a> Exists():检测缓存项是否存在</h2>
<p><code>Exists()</code>：用于检测某个key是否存在。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   n, err := rdb.Exists(ctx, <span class="string">"test"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">if</span> n &gt; <span class="number">0</span> &#123;</span><br><span class="line">      fmt.Println(<span class="string">"存在"</span>)</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      fmt.Println(<span class="string">"不存在"</span>)</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注：<code>Exists()</code>方法可以传入多个key，<strong>返回的第一个结果表示存在的key的数量</strong>，不过工作中我们一般不同时判断多个key是否存在，<strong>一般就判断一个key，所以判断是否大于0即可</strong>；<strong>如果判断判断传入的多个key是否都存在，则返回的结果的值要和传入的key的数量相等</strong>。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c cmdable)</span> <span class="title">Exists</span><span class="params">(ctx context.Context, keys ...<span class="keyword">string</span>)</span> *<span class="title">IntCmd</span></span> &#123;...&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="expireexpireat设置有效期"><a class="markdownIt-Anchor" href="#expireexpireat设置有效期"></a> Expire()&amp;ExpireAt():设置有效期</h2>
<p>使用场景：设置好key后，再设置key的有效期。</p>
<ul>
<li><code>Expire()</code>：设置某个时间段(<code>time.Duration</code>)后过期</li>
<li><code>ExpireAt()</code>：在某个时间点(<code>time.Time</code>)过期失效</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line">   <span class="string">"time"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   result, err := rdb.Expire(ctx, <span class="string">"test1"</span>, time.Minute*<span class="number">3</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">if</span> result &#123;</span><br><span class="line">      fmt.Println(<span class="string">"设置成功! test1将于3分钟后过期"</span>)</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      fmt.Println(<span class="string">"设置失败!"</span>)</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//result, err := rdb.ExpireAt(ctx, "test2", time.Now().Add(time.Second*30)).Result()</span></span><br><span class="line">   <span class="comment">// string转time.Time</span></span><br><span class="line">   str := <span class="string">"2022-07-14T12:52:28Z"</span></span><br><span class="line">   t, err := time.Parse(<span class="string">"2006-01-02T15:04:05Z"</span>, str)</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   b, err := rdb.ExpireAt(ctx, <span class="string">"test2"</span>, t).Result()</span><br><span class="line">   <span class="keyword">if</span> b &#123;</span><br><span class="line">      fmt.Println(<span class="string">"设置成功! test2将于2022-07-14 12:52:28过期"</span>)</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      fmt.Println(<span class="string">"设置失败!"</span>)</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ttlpttl获取有效期"><a class="markdownIt-Anchor" href="#ttlpttl获取有效期"></a> TTL(),PTTL():获取有效期</h2>
<ul>
<li><code>TTL()</code>：获取某个键的剩余有效期（单位：秒(s)）</li>
<li><code>PTTL()</code>：获取某个键的剩余有效期（单位：毫秒(ms)）</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line">   <span class="string">"time"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   rdb.Expire(ctx, <span class="string">"test"</span>, time.Minute*<span class="number">1</span>) <span class="comment">// 设置1分钟后过期</span></span><br><span class="line"></span><br><span class="line">   ttl, err := rdb.TTL(ctx, <span class="string">"test"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(ttl)</span><br><span class="line">   pttl, err := rdb.PTTL(ctx, <span class="string">"test"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(pttl)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="dbsize查看当前数据库key的数量"><a class="markdownIt-Anchor" href="#dbsize查看当前数据库key的数量"></a> DBSize():查看当前数据库key的数量</h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   num, err := rdb.DBSize(ctx).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(num)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="flushdb清空当前数据"><a class="markdownIt-Anchor" href="#flushdb清空当前数据"></a> FlushDB():清空当前数据</h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   <span class="comment">// 清空当前数据库，因为连接的是索引为10的数据库，所以清空的就是10号数据库</span></span><br><span class="line">   result, err := rdb.FlushDB(ctx).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(result) <span class="comment">// OK</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="flushall清空所有数据库"><a class="markdownIt-Anchor" href="#flushall清空所有数据库"></a> FlushAll():清空所有数据库</h2>
<p><strong><mark>慎用！</mark></strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   result, err := rdb.FlushAll(ctx).Result() <span class="comment">// 清空所有数据库,慎用！</span></span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(result) <span class="comment">// OK</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">   rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">      Addr:     <span class="string">"192.168.219.101:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">      Password: <span class="string">"1234"</span>,                 <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">      DB:       <span class="number">10</span>,                     <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">   &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="字符串string类型"><a class="markdownIt-Anchor" href="#字符串string类型"></a> 字符串(string)类型</h1>
<p>这里先介绍常用的字符串操作，此外，字符串(string)类型还有<code>MGet()</code>、<code>Mset()</code>、<code>MSetNX()</code>等同时操作多个key的方法，详见：<a href="https://pkg.go.dev/github.com/go-redis/redis/v8" target="_blank" rel="noopener">https://pkg.go.dev/github.com/go-redis/redis/v8</a></p>
<h2 id="set-设置"><a class="markdownIt-Anchor" href="#set-设置"></a> Set() 设置</h2>
<p><strong>仅仅支持字符串(包含数字)操作</strong>，不支持内置数据编码功能。<strong>如果需要存储Go的非字符串类型，需要提前手动序列化，获取时再反序列化。</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line">   <span class="string">"time"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   err := rdb.Set(ctx, <span class="string">"hello"</span>, <span class="string">"world"</span>, <span class="number">0</span>).Err() <span class="comment">// 0表示永不过期</span></span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   err = rdb.Set(ctx, <span class="string">"test"</span>, <span class="string">"即将过期"</span>, time.Minute*<span class="number">1</span>).Err() <span class="comment">// test这个key将在1分钟后过期</span></span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="setex-设置并指定过期时间"><a class="markdownIt-Anchor" href="#setex-设置并指定过期时间"></a> SetEX() 设置并指定过期时间</h2>
<p>设置键的同时，设置过期时间。</p>
<blockquote>
<p>当某个key已经存在时，可以用<code>SetEX()</code>来对这个key设置过期时间。<code>SetEX()</code>不管该key是否已经存在缓存中，直接覆盖。</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line">   <span class="string">"time"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   err := rdb.SetEX(ctx, <span class="string">"hello"</span>, <span class="string">"world"</span>, time.Minute*<span class="number">3</span>).Err() <span class="comment">// 0表示永不过期</span></span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="setnx-设置并指定过期时间"><a class="markdownIt-Anchor" href="#setnx-设置并指定过期时间"></a> SetNX() 设置并指定过期时间</h2>
<p><code>SetEX()</code>与<code>SetNX()</code>的区别：</p>
<ul>
<li>
<p><code>SetEX()</code>不管该key是否已经存在缓存中，直接覆盖</p>
</li>
<li>
<p><code>SexNX()</code>仅当key不存在的时候才设置，<strong>如果key已经存在则不做任何操作</strong></p>
</li>
</ul>
<blockquote>
<p>还有一点需要注意：如果我们想知道我们调用<code>SetNX()</code>是否设置成功了，可以接着调用<code>Result()</code>方法，返回的第一个值表示是否设置成功了：</p>
<ul>
<li>如果返回false，说明缓存Key已经存在，此次操作虽然没有错误，但是是没有起任何效果的</li>
<li>如果返回true，表示在此之前key是不存在缓存中的，操作是成功的</li>
</ul>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line">   <span class="string">"time"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   ok, err := rdb.SetNX(ctx, <span class="string">"hello"</span>, <span class="string">"world"</span>, time.Minute*<span class="number">5</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">if</span> ok &#123;</span><br><span class="line">      fmt.Println(<span class="string">"key不存在，操作成功"</span>)</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      fmt.Println(<span class="string">"key存在，操作不成功"</span>)</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="get-获取"><a class="markdownIt-Anchor" href="#get-获取"></a> Get() 获取</h2>
<p>如果要获取的key在缓存中并不存在，<code>Get()</code>方法将会返回<code>redis.Nil</code>。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   val, err := rdb.Get(ctx, <span class="string">"hello"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(val)</span><br><span class="line"></span><br><span class="line">   val2, err := rdb.Get(ctx, <span class="string">"test1"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> err == redis.Nil &#123;</span><br><span class="line">         fmt.Println(<span class="string">"key不存在"</span>)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">         log.Fatalln(err)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(val2)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="getrange-字符串截取"><a class="markdownIt-Anchor" href="#getrange-字符串截取"></a> GetRange() 字符串截取</h2>
<p><code>GetRange()</code>：用来截取字符串的部分内容，最后两个参数分别是索引的开始位置和结束位置（左闭右闭，<code>[start,end]</code>）。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   val, err := rdb.GetRange(ctx, <span class="string">"test"</span>, <span class="number">0</span>, <span class="number">3</span>).Result() <span class="comment">// [0,3]</span></span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(val)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注：即使key不存在，调用<code>GetRange()</code>也不会报错，只是返回的截取结果是空<code>&quot;&quot;</code>，可以使用<code>fmt.Printf(&quot;%q\n&quot;, val)</code>来打印测试</p>
</blockquote>
<h2 id="incr-增加1"><a class="markdownIt-Anchor" href="#incr-增加1"></a> Incr() 增加(+1)</h2>
<p><code>Incr()</code>、<code>IncrBy()</code>都是操作数字，对数字进行增加的操作，<code>incr()</code>是执行<strong>原子</strong>加1操作，<code>incrBy()</code>是增加指定的数。</p>
<blockquote>
<p>所谓<strong>原子操作</strong>是指不会被线程调度机制打断的操作：这种操作一旦开始，就一直运行到结束，中间不会有任何context witch(切换到另一个线程)。</p>
<ul>
<li>在单线程中，能够在单条指令中完成的操作都可以认为是“原子操作”，因为中断只能发生于指令之间</li>
<li>在多线程中，不能被其它进程(线程)打断的操作叫原子操作</li>
</ul>
<p>Redis单命令的原子性主要得益于Redis的单线程。</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   val, err := rdb.Get(ctx, <span class="string">"number"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(<span class="string">"val为："</span>, val) <span class="comment">// val为： 1</span></span><br><span class="line">   <span class="comment">// 执行Incr():增加(+1)操作</span></span><br><span class="line">   val2, err := rdb.Incr(ctx, <span class="string">"number"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(<span class="string">"Incr后的val为："</span>, val2) <span class="comment">// Incr后的val为： 2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="incrby-增加按指定步长"><a class="markdownIt-Anchor" href="#incrby-增加按指定步长"></a> IncrBy() 增加(按指定步长)</h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   val, err := rdb.Get(ctx, <span class="string">"number"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(<span class="string">"val为："</span>, val) <span class="comment">// val为： 2</span></span><br><span class="line">   <span class="comment">// 执行IncrBy():增加(按指定步长)操作</span></span><br><span class="line">   val2, err := rdb.IncrBy(ctx, <span class="string">"number"</span>, <span class="number">10</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(<span class="string">"IncrBy后的val为："</span>, val2) <span class="comment">// IncrBy后的val为： 12</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="decr-减少-1"><a class="markdownIt-Anchor" href="#decr-减少-1"></a> Decr() 减少(-1)</h2>
<p><code>Decr()</code>和<code>DecrBy()</code>方法是对数字进行减的操作，和<code>Incr()</code>和<code>IncrBy()</code>正好相反。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   val, err := rdb.Get(ctx, <span class="string">"number"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(<span class="string">"val为："</span>, val) <span class="comment">// val为： 12</span></span><br><span class="line">   <span class="comment">// 执行Decr():减少(-1)操作</span></span><br><span class="line">   val2, err := rdb.Decr(ctx, <span class="string">"number"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(<span class="string">"Decr后的val为："</span>, val2) <span class="comment">// Decr后的val为： 11</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="decrby-减少按指定步长"><a class="markdownIt-Anchor" href="#decrby-减少按指定步长"></a> DecrBy() 减少(按指定步长)</h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   val, err := rdb.Get(ctx, <span class="string">"number"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(<span class="string">"val为："</span>, val) <span class="comment">// val为： 11</span></span><br><span class="line">   <span class="comment">// 执行DecrBy():减少(按指定步长)操作</span></span><br><span class="line">   val2, err := rdb.DecrBy(ctx, <span class="string">"number"</span>, <span class="number">10</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(<span class="string">"DecrBy后的val为："</span>, val2) <span class="comment">// DecrBy后的val为： 1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="append-追加"><a class="markdownIt-Anchor" href="#append-追加"></a> Append() 追加</h2>
<p><code>Append()</code>：往字符串后面追加元素，<strong>返回值是字符串的总长度</strong>。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   str, err := rdb.Get(ctx, <span class="string">"test1"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(str) <span class="comment">// hello，</span></span><br><span class="line">   <span class="comment">// 注意Append()返回值是添加后的字符串长度</span></span><br><span class="line">   length, err := rdb.Append(ctx, <span class="string">"test1"</span>, <span class="string">"world!"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(length) <span class="comment">// 14</span></span><br><span class="line"></span><br><span class="line">   str, err = rdb.Get(ctx, <span class="string">"test1"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(str) <span class="comment">// hello，world!</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="strlen-获取长度"><a class="markdownIt-Anchor" href="#strlen-获取长度"></a> StrLen() 获取长度</h2>
<p><code>StrLen()</code>：获取字符串的长度。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   length, err := rdb.StrLen(ctx, <span class="string">"test"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(length)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="哈希hash类型"><a class="markdownIt-Anchor" href="#哈希hash类型"></a> 哈希(hash)类型</h1>
<p>Redis <code>hash</code>是一个<code>string</code>类型的 field（字段） 和 <code>any</code>类型的value（值） 的映射表，<strong>hash特别适合用于存储对象</strong>。（之前在gobang项目中用hash开存储go的struct）。Redis 中每个<code>hash</code>可以存储2^32 - 1键值对（40多亿）。</p>
<p>当前服务器一般都是将用户登录信息保存到Redis中，这里存储用户登录信息就比较适合用hash表。hash表比string更合适。</p>
<blockquote>
<p>如果我们选择使用string类型来存储用户的信息的时候，我们每次存储的时候就得先序列化成字符串才能存储到redis；从redis拿到用户信息后又得反序列化成数组或对象，这样开销比较大。如果使用hash的话我们通过key(用户ID)+field(属性标签)就可以操作对应属性数据了，既不需要重复存储数据，也不会带来序列化和并发修改控制的问题。</p>
</blockquote>
<h2 id="hset-设置"><a class="markdownIt-Anchor" href="#hset-设置"></a> HSet() 设置</h2>
<p><code>HSet()</code>支持如下格式：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   rdb.HSet(ctx, <span class="string">"user"</span>, <span class="string">"key1"</span>, <span class="string">"value1"</span>, <span class="string">"key2"</span>, <span class="string">"value2"</span>) <span class="comment">// 直接在后面依次指定key和value</span></span><br><span class="line"></span><br><span class="line">   s := []<span class="keyword">string</span>&#123;<span class="string">"id"</span>, <span class="string">"123"</span>, <span class="string">"name"</span>, <span class="string">"张三"</span>&#125;</span><br><span class="line">   rdb.HSet(ctx, <span class="string">"user"</span>, s) <span class="comment">// 通过string切片slice</span></span><br><span class="line"></span><br><span class="line">   m := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]any, <span class="number">0</span>)</span><br><span class="line">   m[<span class="string">"sex"</span>] = <span class="string">"男"</span></span><br><span class="line">   m[<span class="string">"age"</span>] = <span class="number">20</span></span><br><span class="line">   rdb.HSet(ctx, <span class="string">"user"</span>, m) <span class="comment">// 通过map</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>redis中的hash值：</p>
<p><img src="https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220714121448.png" alt="" /></p>
<h2 id="hmset-批量设置"><a class="markdownIt-Anchor" href="#hmset-批量设置"></a> HMset() 批量设置</h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   m := <span class="keyword">map</span>[<span class="keyword">string</span>]any&#123;</span><br><span class="line">      <span class="string">"name"</span>: <span class="string">"李四"</span>,</span><br><span class="line">      <span class="string">"id"</span>:   <span class="number">123</span>,</span><br><span class="line">   &#125;</span><br><span class="line">   rdb.HMSet(ctx, <span class="string">"student"</span>, m)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>redis成功存储hash值：</p>
<p><img src="https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220714122305.png" alt="" /></p>
<h2 id="hget-获取某个元素"><a class="markdownIt-Anchor" href="#hget-获取某个元素"></a> HGet() 获取某个元素</h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   val, err := rdb.HGet(ctx, <span class="string">"student"</span>, <span class="string">"name"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(val)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="hgetall-获取全部元素"><a class="markdownIt-Anchor" href="#hgetall-获取全部元素"></a> HGetAll() 获取全部元素</h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   user, err := rdb.HGetAll(ctx, <span class="string">"user"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(user) <span class="comment">// map[age:20 id:123 key1:value1 key2:value2 name:张三 sex:男]</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="hdel-删除某个元素"><a class="markdownIt-Anchor" href="#hdel-删除某个元素"></a> HDel() 删除某个元素</h2>
<p><code>HDel()</code>支持一次删除多个元素。在参数中写入要删除的hash类型的key即可。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   result, err := rdb.HDel(ctx, <span class="string">"user"</span>, <span class="string">"key1"</span>, <span class="string">"key2"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(result) <span class="comment">// 2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>删除后的user：</p>
<p><img src="https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220714162524.png" alt="" /></p>
<h2 id="hexists-判断元素是否存在"><a class="markdownIt-Anchor" href="#hexists-判断元素是否存在"></a> HExists() 判断元素是否存在</h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   exist, err := rdb.HExists(ctx, <span class="string">"student"</span>, <span class="string">"id"</span>).Result()</span><br><span class="line">   exist2, err := rdb.HExists(ctx, <span class="string">"student"</span>, <span class="string">"age"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(exist)  <span class="comment">// true</span></span><br><span class="line">   fmt.Println(exist2) <span class="comment">// false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="hlen-获取长度"><a class="markdownIt-Anchor" href="#hlen-获取长度"></a> HLen() 获取长度</h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   length, err := rdb.HLen(ctx, <span class="string">"user"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(length) <span class="comment">// 4</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>此时的user：</p>
<p><img src="https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220714163048.png" alt="" /></p>
<h1 id="列表list类型"><a class="markdownIt-Anchor" href="#列表list类型"></a> 列表(list)类型</h1>
<p>Redis <code>list</code>是按插入顺序排序的<code>string</code>列表。可以在列表的**头部（左边）<strong>或</strong>尾部（右边）**添加元素。列表可以包含2^32 - 1个元素（40多亿）。</p>
<h2 id="lpush-将元素从左侧压入链表"><a class="markdownIt-Anchor" href="#lpush-将元素从左侧压入链表"></a> LPush() 将元素从左侧压入链表</h2>
<p><code>LPush()</code>：将数据从左侧压入链表。当指定的key不存在时，会自动创建key。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   <span class="comment">// 返回值是当前列表元素的数量</span></span><br><span class="line">   n, err := rdb.LPush(ctx, <span class="string">"list"</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="string">"hello"</span>, <span class="string">"world"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(n) <span class="comment">// 4</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意<code>LPush()</code>是从左侧压入数据的，所以list如下：</p>
<p><img src="https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220714163844.png" alt="" /></p>
<h2 id="rpush-将元素从右侧压入链表"><a class="markdownIt-Anchor" href="#rpush-将元素从右侧压入链表"></a> RPush() 将元素从右侧压入链表</h2>
<p><code>RPush()</code>：将数据从右侧压入链表。当指定的key不存在时，会自动创建key。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   <span class="comment">// 返回值是当前列表元素的数量</span></span><br><span class="line">   n, err := rdb.RPush(ctx, <span class="string">"list2"</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="string">"hello"</span>, <span class="string">"world"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(n) <span class="comment">// 4</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>RPush()</code>是从右侧压入数据的，所以list2如下：</p>
<p><img src="https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220714164332.png" alt="" /></p>
<h2 id="linsert-在某个位置插入新元素"><a class="markdownIt-Anchor" href="#linsert-在某个位置插入新元素"></a> LInsert() 在某个位置插入新元素</h2>
<blockquote>
<p>函数签名：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c cmdable)</span> <span class="title">LInsert</span><span class="params">(ctx context.Context, key, op <span class="keyword">string</span>, pivot, value <span class="keyword">interface</span>&#123;&#125;)</span> *<span class="title">IntCmd</span></span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>具体点说，是在某个元素的前面或后面插入新元素。</p>
<ul>
<li>op指定为<code>before</code>：在pivot前面插入新元素</li>
<li>op指定为<code>after</code>：在pivot后面插入新元素</li>
</ul>
<blockquote>
<p>注意：即使key列表里有多个值为hello的元素，也只会在第一个值为hello的元素前面插入3，并不会在所有值为hello的前面插入3。</p>
<p>客户端还提供了从前面插入和从后面插入的<code>LInsertBefore()</code>和<code>LInsertAfer()</code>方法。</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   <span class="comment">// 在名为list2的缓存项值为hello的元素前面插入一个值，值为3</span></span><br><span class="line">   n, err := rdb.LInsert(ctx, <span class="string">"list2"</span>, <span class="string">"before"</span>, <span class="string">"hello"</span>, <span class="string">"3"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(n) <span class="comment">// 5</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="lset-设置某个元素的值"><a class="markdownIt-Anchor" href="#lset-设置某个元素的值"></a> LSet() 设置某个元素的值</h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   err := rdb.LSet(ctx, <span class="string">"list"</span>, <span class="number">1</span>, <span class="number">100</span>).Err() <span class="comment">// 索引是从0开始的</span></span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="llen-获取列表元素个数"><a class="markdownIt-Anchor" href="#llen-获取列表元素个数"></a> LLen() 获取列表元素个数</h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   length, err := rdb.LLen(ctx, <span class="string">"list"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(length)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="lindex-根据索引获取列表元素"><a class="markdownIt-Anchor" href="#lindex-根据索引获取列表元素"></a> LIndex() 根据索引获取列表元素</h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   val, err := rdb.LIndex(ctx, <span class="string">"list"</span>, <span class="number">2</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(val)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="lrange-获取某个选定范围的元素集"><a class="markdownIt-Anchor" href="#lrange-获取某个选定范围的元素集"></a> LRange() 获取某个选定范围的元素集</h2>
<p>范围是左闭右闭（<code>[start,end]</code>）</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   list, err := rdb.LRange(ctx, <span class="string">"list"</span>, <span class="number">0</span>, <span class="number">2</span>).Result() <span class="comment">// [0,2]</span></span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(list)        <span class="comment">// [1 100 hello]</span></span><br><span class="line">   fmt.Printf(<span class="string">"%T\n"</span>, list) <span class="comment">// []string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="lpop-从列表左侧弹出数据"><a class="markdownIt-Anchor" href="#lpop-从列表左侧弹出数据"></a> LPop() 从列表左侧弹出数据</h2>
<p>Push和Pop操作，跟数据结构中的类似。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   val, err := rdb.LPop(ctx, <span class="string">"list"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(val)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="rpop-从列表右侧弹出数据"><a class="markdownIt-Anchor" href="#rpop-从列表右侧弹出数据"></a> RPop() 从列表右侧弹出数据</h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   val, err := rdb.RPop(ctx, <span class="string">"list"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(val)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="lrem-根据值移除元素"><a class="markdownIt-Anchor" href="#lrem-根据值移除元素"></a> LRem() 根据值移除元素</h2>
<blockquote>
<p>函数签名：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c cmdable)</span> <span class="title">LRem</span><span class="params">(ctx context.Context, key <span class="keyword">string</span>, count <span class="keyword">int64</span>, value <span class="keyword">interface</span>&#123;&#125;)</span> *<span class="title">IntCmd</span></span></span><br></pre></td></tr></table></figure>
</blockquote>
<ul>
<li><code>count</code>：要删除元素的个数</li>
<li><code>value</code>：根据指定值删除该元素</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   val, err := rdb.LRem(ctx, <span class="string">"list"</span>, <span class="number">2</span>, <span class="string">"hello"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(<span class="string">"删除了"</span>, val, <span class="string">"个元素"</span>) <span class="comment">// 删除了 2 个元素</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>删除前：</p>
<p><img src="https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220714181008.png" alt="" /></p>
<p>删除后：</p>
<p><img src="https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220714181107.png" alt="" /></p>
<h1 id="集合set类型"><a class="markdownIt-Anchor" href="#集合set类型"></a> 集合(set)类型</h1>
<p>Redis <code>set</code>对外提供的功能与<code>list</code>类似是一个列表的功能，特殊之处在于<code>set</code>是可以<strong>自动去重</strong>的，当你需要存储一个列表数据，又不希望出现重复数据，<code>set</code>是一个很好的选择，并且<code>set</code>提供了判断某个成员是否在一个<code>set</code>集合内的接口，这是<code>list</code>所不能提供的。</p>
<p>Redis的<code>set</code>是<code>string</code>类型的无序集合。<strong>它底层其实是一个value为null的hash表，所以添加、删除、查找的复杂度都是O(1)。</strong></p>
<p>集合数据的特征：</p>
<ol>
<li><strong>元素不能重复</strong>，保持唯一性</li>
<li><strong>元素无序</strong>，不能使用索引(下标)操作</li>
</ol>
<h2 id="sadd-添加元素"><a class="markdownIt-Anchor" href="#sadd-添加元素"></a> SAdd() 添加元素</h2>
<p>当指定的key不存在时，会自动创建key。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   rdb.SAdd(ctx, <span class="string">"team"</span>, <span class="string">"张三"</span>, <span class="string">"lisi"</span>, <span class="string">"tom"</span>)</span><br><span class="line">   rdb.SAdd(ctx, <span class="string">"team"</span>, <span class="string">"王五"</span>)</span><br><span class="line">   rdb.SAdd(ctx, <span class="string">"team"</span>, <span class="string">"张三"</span>) <span class="comment">// 重复添加无效，因为张三已经被添加到team集合中了</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="spop-随机弹出一个元素"><a class="markdownIt-Anchor" href="#spop-随机弹出一个元素"></a> SPop() 随机弹出一个元素</h2>
<p><code>SPop()</code>：从集合中随机弹出元素的，如果想一次弹出多个元素，可以使用<code>SPopN()</code>方法。（<code>set</code>的无序性，所以是随机的）</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   val, err := rdb.SPop(ctx, <span class="string">"team"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(val)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="spopn-随机弹出多个元素"><a class="markdownIt-Anchor" href="#spopn-随机弹出多个元素"></a> SPopN() 随机弹出多个元素</h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   val, err := rdb.SPopN(ctx, <span class="string">"team"</span>, <span class="number">2</span>).Result() <span class="comment">// 指定随机弹出两个</span></span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(val)</span><br><span class="line">   fmt.Printf(<span class="string">"%T"</span>, val) <span class="comment">// []string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="srem-删除集合里指定的值"><a class="markdownIt-Anchor" href="#srem-删除集合里指定的值"></a> SRem() 删除集合里指定的值</h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   n, err := rdb.SRem(ctx, <span class="string">"team"</span>, <span class="string">"张三"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(n) <span class="comment">// 1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="smembers-获取所有成员"><a class="markdownIt-Anchor" href="#smembers-获取所有成员"></a> SMembers() 获取所有成员</h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   result, err := rdb.SMembers(ctx, <span class="string">"team"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(result)</span><br><span class="line">   fmt.Printf(<span class="string">"%T"</span>, result) <span class="comment">// []string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="sismember-判断元素是否在集合中"><a class="markdownIt-Anchor" href="#sismember-判断元素是否在集合中"></a> SIsMember() 判断元素是否在集合中</h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   exists, err := rdb.SIsMember(ctx, <span class="string">"team"</span>, <span class="string">"张三"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(exists)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="scard-获取集合元素个数"><a class="markdownIt-Anchor" href="#scard-获取集合元素个数"></a> SCard() 获取集合元素个数</h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   length, err := rdb.SCard(ctx, <span class="string">"team"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(length)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="sunion-并集sdiff-差集sinter-交集"><a class="markdownIt-Anchor" href="#sunion-并集sdiff-差集sinter-交集"></a> SUnion() 并集；SDiff() 差集；SInter() 交集</h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   rdb.SAdd(ctx, <span class="string">"setA"</span>, <span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>)</span><br><span class="line">   rdb.SAdd(ctx, <span class="string">"setB"</span>, <span class="string">"a"</span>, <span class="string">"d"</span>, <span class="string">"e"</span>, <span class="string">"f"</span>)</span><br><span class="line"></span><br><span class="line">   <span class="comment">//并集</span></span><br><span class="line">   union, err := rdb.SUnion(ctx, <span class="string">"setA"</span>, <span class="string">"setB"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(union) <span class="comment">// [c e f b d a]</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">// 差集</span></span><br><span class="line">   diff, err := rdb.SDiff(ctx, <span class="string">"setA"</span>, <span class="string">"setB"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(diff) <span class="comment">// [c b]</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">// 交集</span></span><br><span class="line">   inter, err := rdb.SInter(ctx, <span class="string">"setA"</span>, <span class="string">"setB"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(inter) <span class="comment">// [d a]</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="有序集合zset类型"><a class="markdownIt-Anchor" href="#有序集合zset类型"></a> 有序集合(zset)类型</h1>
<p>Redis 有序集合<code>zset</code>和集合<code>set</code>一样也是<code>string</code>类型元素的集合，且不允许重复的成员。</p>
<p>不同的是每个元素都会关联一个<code>double</code>类型的分数score。redis正是通过分数来为集合中的成员进行从小到大的排序。</p>
<p>有序集合的成员是唯一的，但**分数(score)**却可以重复。</p>
<p><strong>集合是通过哈希表实现的，所以添加，删除，查找的复杂度都是O(1)</strong>。 集合中最大的成员数为 2^32 - 1 (4294967295, 每个集合可存储40多亿个成员)。</p>
<h2 id="zadd-添加元素"><a class="markdownIt-Anchor" href="#zadd-添加元素"></a> ZAdd() 添加元素</h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   rdb.ZAdd(ctx, <span class="string">"zSet"</span>, &amp;redis.Z&#123;</span><br><span class="line">      Score:  <span class="number">0</span>,</span><br><span class="line">      Member: <span class="string">"hello"</span>,</span><br><span class="line">   &#125;)</span><br><span class="line">   rdb.ZAdd(ctx, <span class="string">"zSet"</span>, &amp;redis.Z&#123;</span><br><span class="line">      Score:  <span class="number">2.3</span>,</span><br><span class="line">      Member: <span class="string">"world"</span>,</span><br><span class="line">   &#125;)</span><br><span class="line">   rdb.ZAdd(ctx, <span class="string">"zSet"</span>, &amp;redis.Z&#123;</span><br><span class="line">      Score:  <span class="number">3.14</span>,</span><br><span class="line">      Member: <span class="string">"pai"</span>,</span><br><span class="line">   &#125;)</span><br><span class="line">   rdb.ZAdd(ctx, <span class="string">"zSet"</span>, &amp;redis.Z&#123;</span><br><span class="line">      Score:  <span class="number">-12.3</span>,</span><br><span class="line">      Member: <span class="string">"张三"</span>,</span><br><span class="line">   &#125;)</span><br><span class="line">   rdb.ZAdd(ctx, <span class="string">"zSet"</span>, &amp;redis.Z&#123;</span><br><span class="line">      Score:  <span class="number">10</span>,</span><br><span class="line">      Member: <span class="string">"tom"</span>,</span><br><span class="line">   &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>添加后结果如下：</p>
<p><img src="https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220715110721.png" alt="" /></p>
<h2 id="zincrby-增加元素分值"><a class="markdownIt-Anchor" href="#zincrby-增加元素分值"></a> ZIncrBy() 增加元素分值</h2>
<blockquote>
<p>函数签名：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c cmdable)</span> <span class="title">ZIncrBy</span><span class="params">(ctx context.Context, key <span class="keyword">string</span>, increment <span class="keyword">float64</span>, member <span class="keyword">string</span>)</span> *<span class="title">FloatCmd</span></span></span><br></pre></td></tr></table></figure>
</blockquote>
<ul>
<li><code>increment</code>参数可以为负数，表示减少score</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   rdb.ZIncrBy(ctx, <span class="string">"zSet"</span>, <span class="number">-3.14</span>, <span class="string">"pai"</span>)</span><br><span class="line">   rdb.ZIncrBy(ctx, <span class="string">"zSet"</span>, <span class="number">123</span>, <span class="string">"hello"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>修改前后：</p>
<center class="half">
    <img src="https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220715110721.png" width="350"/>
    <img src="https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220715111826.png" width="350"/>
</center>
<h2 id="zrangezrevrange-获取根据score排序后的数据段"><a class="markdownIt-Anchor" href="#zrangezrevrange-获取根据score排序后的数据段"></a> ZRange()&amp;ZRevRange() 获取根据score排序后的数据段</h2>
<p><code>ZRange()</code>&amp;<code>ZRevRange()</code>：返回根据分值过滤之后的列表，需要提供分值区间。</p>
<blockquote>
<ul>
<li><code>ZRange()</code>：结果按score升序排序（自然顺序）</li>
<li><code>ZRevRangeByScore()</code>：结果按score降序排序</li>
</ul>
<p>使用方法是完全一样的。</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   result, err := rdb.ZRangeByScore(ctx, <span class="string">"zSet"</span>, &amp;redis.ZRangeBy&#123;</span><br><span class="line">      Min:    <span class="string">"2"</span>,</span><br><span class="line">      Max:    <span class="string">"20"</span>,</span><br><span class="line">      Offset: <span class="number">0</span>,</span><br><span class="line">      Count:  <span class="number">0</span>,</span><br><span class="line">   &#125;).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(result)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>关于<code>Offset</code>和<code>Count</code>，这是分页查询常见的了。当<code>Count</code>为0时，表示查询全部。</p>
</blockquote>
<h2 id="zcard-获取元素个数"><a class="markdownIt-Anchor" href="#zcard-获取元素个数"></a> ZCard() 获取元素个数</h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   count, err := rdb.ZCard(ctx, <span class="string">"zSet"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(count)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="zcount-获取区间内元素个数"><a class="markdownIt-Anchor" href="#zcount-获取区间内元素个数"></a> ZCount() 获取区间内元素个数</h2>
<blockquote>
<p>函数签名：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c cmdable)</span> <span class="title">ZCount</span><span class="params">(ctx context.Context, key, min, max <span class="keyword">string</span>)</span> *<span class="title">IntCmd</span></span></span><br></pre></td></tr></table></figure>
</blockquote>
<p><code>ZCount()</code>：获取分值在<code>[mim, max]</code>的元素的数量（左闭右闭）。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   count, err := rdb.ZCount(ctx, <span class="string">"zSet"</span>, <span class="string">"2"</span>, <span class="string">"20"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(count)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="zscore-获取元素的score"><a class="markdownIt-Anchor" href="#zscore-获取元素的score"></a> ZScore() 获取元素的score</h2>
<p><code>ZScore()</code>：获取元素的分值score。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   score, err := rdb.ZScore(ctx, <span class="string">"zSet"</span>, <span class="string">"hello"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(score)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="zrankzrevrank-获取某个元素在集合中的排名"><a class="markdownIt-Anchor" href="#zrankzrevrank-获取某个元素在集合中的排名"></a> ZRank()&amp;ZRevRank() 获取某个元素在集合中的排名</h2>
<p><code>ZRank()</code>&amp;<code>ZRevRank()</code> ：获取某个元素在集合中的排名。</p>
<blockquote>
<ul>
<li><code>ZRank()</code>：返回元素在集合中的升序排名情况，<strong>从0开始</strong></li>
<li><code>ZRevRank()</code>：返回元素在集合中的降序排名情况，<strong>从0开始</strong>（与<code>ZRank()</code>正好相反，类似倒数第几，因为是从0开始所以最末尾的元素是倒数第0）</li>
</ul>
<p>使用方法是完全一样的。效果很简单自己玩一玩就明白函数是什么意思了。</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   result, err := rdb.ZRank(ctx, <span class="string">"zSet"</span>, <span class="string">"tom"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(result)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="zrem-删除元素"><a class="markdownIt-Anchor" href="#zrem-删除元素"></a> ZRem() 删除元素</h2>
<p><code>ZRem()</code>：通过元素的值来删除元素。（注意是元素值而不是score）</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   val, err := rdb.ZRem(ctx, <span class="string">"zSet"</span>, <span class="string">"张三"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(val)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="zremrangebyrank-根据排名删除"><a class="markdownIt-Anchor" href="#zremrangebyrank-根据排名删除"></a> ZRemRangeByRank() 根据排名删除</h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   <span class="comment">// 按照升序排序删除第1个和第2个元素</span></span><br><span class="line">   val, err := rdb.ZRemRangeByRank(ctx, <span class="string">"zSet"</span>, <span class="number">0</span>, <span class="number">1</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(val)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="zremrangebyscore-根据分值区间删除"><a class="markdownIt-Anchor" href="#zremrangebyscore-根据分值区间删除"></a> ZRemRangeByScore() 根据分值区间删除</h2>
<blockquote>
<p>函数签名：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c cmdable)</span> <span class="title">ZRemRangeByScore</span><span class="params">(ctx context.Context, key, min, max <span class="keyword">string</span>)</span> *<span class="title">IntCmd</span></span></span><br></pre></td></tr></table></figure>
</blockquote>
<p><code>ZRemRangeByScore()</code>：删除分值区间在<code>[min,max]</code>的所有元素（左闭右闭）</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"context"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">   <span class="string">"log"</span></span><br><span class="line"></span><br><span class="line">   <span class="string">"github.com/go-redis/redis/v8"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = context.Background()</span><br><span class="line"><span class="keyword">var</span> rdb *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   <span class="comment">// 删除分值区间在[100,123]之间的所有元素</span></span><br><span class="line">   val, err := rdb.ZRemRangeByScore(ctx, <span class="string">"zSet"</span>, <span class="string">"100"</span>, <span class="string">"123"</span>).Result()</span><br><span class="line">   <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      log.Fatalln(err)</span><br><span class="line">   &#125;</span><br><span class="line">   fmt.Println(val)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb = redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"127.0.0.1:6379"</span>, <span class="comment">// redis地址</span></span><br><span class="line">		Password: <span class="string">""</span>,               <span class="comment">// redis密码，没有则留空</span></span><br><span class="line">		DB:       <span class="number">10</span>,               <span class="comment">// 默认数据库（不指定默认是0）</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:qingbo1011@163.com">qingbo</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://www.qingbo1011.top/2022/05/22/Go%E6%93%8D%E4%BD%9CRedis/">http://www.qingbo1011.top/2022/05/22/Go%E6%93%8D%E4%BD%9CRedis/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://www.qingbo1011.top" target="_blank">Qing's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Database/">Database</a><a class="post-meta__tags" href="/tags/Go/">Go</a><a class="post-meta__tags" href="/tags/Redis/">Redis</a></div><div class="post_share"><div class="social-share" data-image="https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20231003161115.png" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2022/05/30/Iris%E5%85%A5%E9%97%A8/"><img class="prev_cover" src="https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220728152550.png" onerror="onerror=null;src='https://gitee.com/qingyu1011/blog_img/raw/master/img/20201006230435.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Iris入门</div></div></a></div><div class="next-post pull_right"><a href="/2022/05/21/Gin+WebSocket+MongoDB%E7%9A%84IM%E5%8D%B3%E6%97%B6%E8%81%8A%E5%A4%A9Demo/"><img class="next_cover" src="https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220525201522.png" onerror="onerror=null;src='https://gitee.com/qingyu1011/blog_img/raw/master/img/20201006230435.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Gin+Websocket+MangoDB实现的IM系统</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2022/06/25/Gorm v2/" title="GORM v2操作MySQL"><img class="relatedPosts_cover" src="https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220806214514.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2022-06-25</div><div class="relatedPosts_title">GORM v2操作MySQL</div></div></a></div><div class="relatedPosts_item"><a href="/2022/06/21/Go操作ElasticSearch/" title="Go操作Elasticsearch"><img class="relatedPosts_cover" src="https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220705111821.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2022-06-21</div><div class="relatedPosts_title">Go操作Elasticsearch</div></div></a></div><div class="relatedPosts_item"><a href="/2021/04/11/Jedis/" title="Jedis"><img class="relatedPosts_cover" src="https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220508214944.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2021-04-11</div><div class="relatedPosts_title">Jedis</div></div></a></div><div class="relatedPosts_item"><a href="/2022/05/20/MangoDB/" title="MongoDB"><img class="relatedPosts_cover" src="https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220529151443.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2022-05-20</div><div class="relatedPosts_title">MongoDB</div></div></a></div><div class="relatedPosts_item"><a href="/2021/04/08/Redis入门/" title="Redis入门"><img class="relatedPosts_cover" src="https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220509103115.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2021-04-08</div><div class="relatedPosts_title">Redis入门</div></div></a></div><div class="relatedPosts_item"><a href="/2022/05/21/Gin+WebSocket+MongoDB的IM即时聊天Demo/" title="Gin+Websocket+MangoDB实现的IM系统"><img class="relatedPosts_cover" src="https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220525201522.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2022-05-21</div><div class="relatedPosts_title">Gin+Websocket+MangoDB实现的IM系统</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var requestSetting = function (from,set) {
  var from = from
  var setting = set.split(',').filter(function(item){
  return from.indexOf(item) > -1
  });
  setting = setting.length == 0 ? from :setting;
  return setting
}

var guestInfo = requestSetting(['nick','mail','link'],'nick,mail,link')
var requiredFields = requestSetting(['nick','mail','link'],'nick,mail')

window.valine = new Valine({
  el:'#vcomment',
  appId: 'oNS5Emx1qUL3wN5yvPLKol0W-gzGzoHsz',
  appKey: 'ytbw0ho3DMX0FeoAOWa37lf9',
  notify: false,
  verify: false,
  placeholder: 'Stay hungry,stay foolish~',
  avatar: 'monsterid',
  meta: guestInfo,
  pageSize: '10',
  lang: 'zh-CN',
  recordIP: false,
  serverURLs: '',
  emojiCDN: 'https://',
  emojiMaps: {"欢呼":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502100836.gif","笑眼":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502100849.gif","花心":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502100907.gif","吐舌":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502100937.gif","疑问":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502100951.gif","滑稽":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502101004.gif","太开心":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502101017.gif","酷":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502101029.gif","怒":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502101044.gif","阴险":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502101100.gif","委屈":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502101116.gif","乖":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502101129.gif","你懂的":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502101204.gif","小乖":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502101215.gif","突然兴奋":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502101228.gif","喷":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502101241.gif","哈哈":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502101255.gif","喝酒":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502101305.gif","汗":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502101323.gif","笑尿":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502102004.gif","嘿嘿嘿":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502102018.gif","真棒":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502102047.gif","托腮":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502102108.gif","微笑":"https://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/e3/2018new_weixioa02_org.png","礼貌":"https://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/09/2018new_keai_org.png","笑哭":"https://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/4a/2018new_xiaoku_thumb.png","无奈":"https://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/83/2018new_kuxiao_org.png","爱你":"https://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f6/2018new_aini_org.png","吃瓜":"https://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/01/2018new_chigua_thumb.png","doge":"https://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a1/2018new_doge02_org.png","dog":"https://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/22/2018new_erha_org.png","cat":"https://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7b/2018new_miaomiao_thumb.png","星星眼":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502102225.png","酸了":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502102240.png","大哭":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502102254.png","傲娇":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502102314.png","给心心":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502102328.png","嘿哈":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502102345.png","custom0":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502101410.gif","custom1":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502101424.webp","狗头":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502101710.png","搬砖中":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502101744.png","忙到飞起":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502102411.png","裂开":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502102426.png","叹气":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502102439.png","让我看看":"https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220502102456.png","panda0":"https://bbs.res.meizu.com/static/image/smiley/panda/_000.png","panda1":"https://bbs.res.meizu.com/static/image/smiley/panda/_001.png","panda2":"https://bbs.res.meizu.com/static/image/smiley/panda/_002.png","panda3":"https://bbs.res.meizu.com/static/image/smiley/panda/_003.png","panda4":"https://bbs.res.meizu.com/static/image/smiley/panda/_004.png","panda5":"https://bbs.res.meizu.com/static/image/smiley/panda/_005.png","panda6":"https://bbs.res.meizu.com/static/image/smiley/panda/_006.png","panda7":"https://bbs.res.meizu.com/static/image/smiley/panda/_007.png","panda8":"https://bbs.res.meizu.com/static/image/smiley/panda/_008.png","panda9":"https://bbs.res.meizu.com/static/image/smiley/panda/_009.png","panda10":"https://bbs.res.meizu.com/static/image/smiley/panda/_010.png","panda11":"https://bbs.res.meizu.com/static/image/smiley/panda/_011.png","panda12":"https://bbs.res.meizu.com/static/image/smiley/panda/_012.png","panda13":"https://bbs.res.meizu.com/static/image/smiley/panda/_013.png","panda14":"https://bbs.res.meizu.com/static/image/smiley/panda/_014.png","panda15":"https://bbs.res.meizu.com/static/image/smiley/panda/_015.png","panda16":"https://bbs.res.meizu.com/static/image/smiley/panda/_016.png","panda17":"https://bbs.res.meizu.com/static/image/smiley/panda/_017.png","panda18":"https://bbs.res.meizu.com/static/image/smiley/panda/_018.png","panda19":"https://bbs.res.meizu.com/static/image/smiley/panda/_019.png","panda20":"https://bbs.res.meizu.com/static/image/smiley/panda/_020.png","panda21":"https://bbs.res.meizu.com/static/image/smiley/panda/_021.png","panda22":"https://bbs.res.meizu.com/static/image/smiley/panda/_022.png","panda23":"https://bbs.res.meizu.com/static/image/smiley/panda/_023.png","panda24":"https://bbs.res.meizu.com/static/image/smiley/panda/_024.png","panda25":"https://bbs.res.meizu.com/static/image/smiley/panda/_025.png","panda26":"https://bbs.res.meizu.com/static/image/smiley/panda/_026.png","panda27":"https://bbs.res.meizu.com/static/image/smiley/panda/_027.png","panda28":"https://bbs.res.meizu.com/static/image/smiley/panda/_028.png","panda29":"https://bbs.res.meizu.com/static/image/smiley/panda/_029.png"},
  enableQQ: false,
  requiredFields: requiredFields
});</script></div></article></main><footer id="footer" style="background-image: url(https://img-qingbo.oss-cn-beijing.aliyuncs.com/img/20220715143752.png)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By qingbo</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="footer_custom_text">宇宙很大，生活更大</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="/js/third-party/fireworks.js"></script><script id="ribbon_piao" mobile="false" src="/js/third-party/piao.js"></script><script src="/js/third-party/activate-power-mode.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
document.body.addEventListener('input', POWERMODE);
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="/js/search/local-search.js"></script></body></html>